<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html" charset="utf-8" />
    <title>Family Tree</title>
    <script src="family.js" type="text/javascript"></script>
    <script src="lookupTable.js"></script>
    <script src="data.js"></script>
    <style>
        .label {
            font-family: 'Arial', 'sans-serif';
            text-align: center;
            position: absolute;
            background-color: white;
            border: 2px solid black;
            border-radius: 6px;
            padding: 5px;
            cursor: pointer;
        }
        .label img { max-width: 70px; }
        .lifespan { font-size: 10pt; white-space: nowrap; }
        #control-panel {
            position: fixed;
            width: 100%;
            background: #f7f7f7;
            border-bottom: 1px solid black;
            z-index: 10;
            padding: 8px;
        }
        body {
            padding: 0;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #f0f0f0;
        }
        .pos-root { border-color: yellow; border-width: 5px; }
        .label:hover { background: #CCF; z-index: 10; }
        .pos-ancestor { border-color: orange; border-width: 5px; }
        .text-ancestor { color: orange; }
        .pos-blood { border-color: red; border-width: 3px; }
        .text-blood { color: red; }
        .pos-descendant { border-color: olive; border-width: 5px; }
        .text-descendant { color: olive; }
        .pos-other { border-color: black; border-width: 1px; }
        .text-other { color: black; }
        .drawn-line { z-index: -1; border-width: 1px !important; }
        .label.has-info {
            background-image: url('info-icon.png');
            background-repeat: no-repeat;
            background-position: right top;
            background-size: 10px 10px;
        }
        .label:hover .info { display: block; }
        #panel-bottom ul { margin-top: 2px; margin-bottom: 2px; }
        #login-panel, #lunar-info, #subtree-input {
            text-align: center;
            margin: 10px;
        }
        #lunar-date {
            font-size: 18px;
            padding: 10px;
            border: 2px solid #4682b4;
            border-radius: 8px;
            background-color: #e6f3fa;
            width: 600px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            font-family: 'Arial', sans-serif;
        }
        #reminder {
            font-size: 16px;
            padding: 15px;
            width: 600px;
            margin-top: 10px;
            color: #8b0000; /* Dark red text */
            background: linear-gradient(to bottom, #fdf6e3, #f9e8b8); /* Parchment gradient */
            border: 3px double #8b4513; /* Double brown border */
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), inset 0 0 10px rgba(139, 69, 19, 0.1); /* Outer shadow + inner glow */
            font-family: 'Georgia', serif; /* Classic serif font */
            white-space: pre-wrap;
            position: relative;
            overflow: hidden;
        }
        #reminder::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.2), transparent); /* Subtle texture */
            pointer-events: none;
        }
        #lunar-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
        }
        button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover { background-color: #45a049; }
    </style>
</head>
<body>
    <div id="lunar-info">
        <input type="text" id="lunar-date" readonly>
        <div id="reminder"></div>
    </div>
    <div id="login-panel">
        <p>Enter password to view the family tree:</p>
        <input type="password" id="password-input">
        <button onclick="checkPassword()">Submit</button>
        <div id="subtree-input" style="display: none;">
            <p>Or enter a Person ID for a subtree:</p>
            <input type="number" id="id-input" placeholder="e.g., 1">
            <button onclick="showSubtree()">Show Subtree</button>
        </div>
    </div>

    <div id="control-panel" style="display: none;">
        <div id="panel-top">
            <span>Family tree of <b><span id="root-name"></span></b></span>
            <span>and
                <select id="detail-picker" onchange="updateDetail()">
                    <option value="0">descendants, ancestors</option>
                    <option value="1">descendants, ancestors + their children, siblings</option>
                    <option value="2">descendants, ancestors + their grandchildren, cousins, nieces/nephews</option>
                    <option value="3">descendants, ancestors + their great-grandchildren, 2nd cousins</option>
                    <option value="Infinity" selected="selected">descendants, ancestors + all descendants of ancestors</option>
                    <option value="Everyone">everyone</option>
                </select>
            </span>
            <span id="tree-information"></span>
        </div>
        <div id="panel-bottom">
            <div id="info-pane-placeholder">
                <i>Hover your mouse on a person with <img src="info-icon.png" height="12px"> for their information</i>
                <br>See the <a target="_blank" href="https://github.com/daveagp/family-tree">source code</a> on GitHub
            </div>
            <div id="info-pane" style="display: none">About <i><span id="info-pane-name"></span></i>:
                <span id="info-pane-details"></span>
            </div>
        </div>
    </div>

    <script>
        const correctPassword = "Thuy";
        let familyData = datajs;

        function checkPassword() {
            const input = document.getElementById('password-input').value;
            if (input === correctPassword) {
                document.getElementById('login